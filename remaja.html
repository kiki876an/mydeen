<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Refleksi Iman & Dakwah Remaja</title>
<style>
body { font-family: 'Poppins', sans-serif; margin:0; padding:0; background: linear-gradient(135deg,#ffdede,#d6f0ff,#e2ffe3); color:#333; }
.container { max-width: 700px; margin: 20px auto; padding:25px; background:rgba(255,255,255,0.95); border-radius:25px; box-shadow:0 6px 20px rgba(0,0,0,0.15); }
h1 { text-align:center; color:#5b21b6; margin-bottom:25px; font-size:28px;}
input, textarea, select { width:100%; padding:12px; border-radius:15px; border:1px solid #ccc; margin-bottom:12px; font-size:16px; box-sizing:border-box; }
button { padding:12px 22px; border:none; border-radius:15px; background:#5b21b6; color:white; cursor:pointer; margin-top:5px; font-size:16px; transition: all 0.2s ease; }
button:hover { opacity:0.9; transform: scale(1.05); }
.card { background:#fff; padding:12px; border-radius:15px; margin-bottom:12px; box-shadow:0 3px 8px rgba(0,0,0,0.08); }
.confetti { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; }
.admin-panel { background:#fff0f5; padding:12px; border-radius:15px; margin-bottom:15px; }
.admin-btn { padding:6px 12px; font-size:13px; border-radius:8px; border:none; cursor:pointer; margin-left:5px; }
.admin-btn.edit { background:#60a5fa; color:white; }
.admin-btn.delete { background:#f87171; color:white; }
#thanks { font-size:18px; margin-top:10px; font-weight:bold; color:#6b21a8; }
#questionPage { font-size:18px; font-weight:600; margin-bottom:10px; }
.progress-container { background:#e0e0e0; border-radius:20px; height:12px; margin-bottom:15px; }
.progress-bar { height:100%; width:0%; background:#5b21b6; border-radius:20px; transition: width 0.3s; }
</style>
</head>
<body>
<div class="container">
<h1>Refleksi Iman & Dakwah Remaja üåü</h1>

<div id="nicknameDiv">
  <label>Halo! Masukkan nama panggilanmu dulu üòÑ</label>
  <input type="text" id="nicknameInput" placeholder="Misal: Bintang, Rara, Alex">
  <button onclick="saveNickname()">Simpan</button>
</div>

<div id="adminDiv" class="admin-panel" style="display:none;">
  <h2>üîß Panel Admin</h2>
  <input type="text" id="newQuestionInput" placeholder="Tulis pertanyaan baru...">
  <button onclick="addQuestion()">Tambah Pertanyaan</button>
  <div id="questionsList" style="margin-top:10px;"></div>
</div>

<div id="qnaDiv" style="display:none;">
  <div class="progress-container">
    <div id="progressBar" class="progress-bar"></div>
  </div>
  <div id="questionPage"></div>

  <div id="answerSection">
    <textarea id="answerInput" placeholder="Tulis jawabanmu di sini..." rows="4"></textarea>
    <div style="margin-bottom:12px;">
      <button onclick="startRecording()">üé§ Rekam Jawaban</button>
      <button onclick="stopRecording()">‚èπ Stop</button>
    </div>
  </div>

  <div id="choiceSection" style="display:none;">
    <select id="choiceInput"></select>
  </div>

  <button onclick="submitAnswer()">Kirim Jawaban ‚ú®</button>
  <div id="thanks"></div>

  <div style="margin-top:15px;">
    <button onclick="prevQuestion()">‚èÆ Sebelumnya</button>
    <button onclick="nextQuestion()">Selanjutnya ‚è≠</button>
  </div>
</div>

<canvas id="confettiCanvas" class="confetti"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<script>
// Pertanyaan + tipe
let questions = [
  {q:"Bagaimana cara membuktikan Tuhan itu ada?", type:"essay"},
  {q:"Kenapa memilih Tuhan Allah?", type:"essay"},
  {q:"Kenapa kita membutuhkan Rasul dan apa yang dibawa Rasul?", type:"essay"},
  {q:"Kenapa memilih Islam? Apa perubahan setelah memikirkan akidah?", type:"essay"},
  {q:"Apa bedanya ide Islam dengan ide sekuler? Wajarkah seorang muslim beride sekuler?", type:"essay"},
  {q:"Dari mana manusia berasal? Untuk apa hidup? Kemana setelah mati?", type:"essay"},
  {q:"Bagaimana kamu menggambarkan hidup seorang muslim sejati?", type:"essay"},
  {q:"Apa tindakan yang benar setelah meyakini adanya Sang Pencipta?", type:"essay"},
  {q:"Apa yang kamu tau tentang khilafah?", type:"essay"},
  {q:"Apakah kamu setuju dengan khilafah?", type:"choice", choices:["Ya","Tidak"]},
  {q:"Kenapa harus memperjuangkan diterapkannya syariat?", type:"essay"},
  {q:"Apakah kamu akan lanjut berdakwah bersama jamaah?", type:"choice", choices:["Ya","Tidak"]},
  {q:"Khilafah bukan tujuan utama, tapi syariat Islam hanya bisa diterapkan secara menyeluruh ketika ada khilafahnya. Lanjut belajar dan berdakwah?", type:"choice", choices:["Ya","Tidak"]},
  {q:"Untuk menjaga iman, punya circle yang baik, strategi dakwah jelas, punya pemahaman Islam lebih jelas, apakah kamu bersedia meluangkan waktu 2 jam per minggu beserta waktu untuk berdakwah?", type:"choice", choices:["1 - Tidak siap","2","3","4","5 - Sangat siap"]}
];
let answers = [];
let nickname = "";
let currentIndex = 0;

// Speech recognition
let recognition;
if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
  const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new SpeechRecognition();
  recognition.lang = 'id-ID';
  recognition.continuous = false;
  recognition.interimResults = false;
  recognition.onresult = (event) => {
    let transcript = event.results[0][0].transcript;
    document.getElementById("answerInput").value += transcript;
  };
} else { recognition = null; }

function saveNickname(){
  nickname = document.getElementById("nicknameInput").value.trim();
  if(!nickname){ alert("Isi nama dulu ya"); return; }
  localStorage.setItem("nickname", nickname);
  document.getElementById("nicknameDiv").style.display="none";
  document.getElementById("qnaDiv").style.display="block";
  showQuestion();
}

function showQuestion(){
  const q = questions[currentIndex];
  document.getElementById("questionPage").textContent = `Pertanyaan ${currentIndex+1}: ${q.q}`;
  document.getElementById("thanks").textContent="";
  document.getElementById("answerSection").style.display = q.type==="essay"?"block":"none";
  document.getElementById("choiceSection").style.display = q.type==="choice"?"block":"none";
  if(q.type==="choice"){
    const sel = document.getElementById("choiceInput");
    sel.innerHTML="";
    q.choices.forEach(c=>{ const opt=document.createElement("option"); opt.value=c; opt.text=c; sel.appendChild(opt); });
  }
  updateProgress();
}

function updateProgress(){
  const percent = ((currentIndex+1)/questions.length)*100;
  document.getElementById("progressBar").style.width = percent+"%";
}

function nextQuestion(){ if(currentIndex<questions.length-1){ currentIndex++; showQuestion(); } }
function prevQuestion(){ if(currentIndex>0){ currentIndex--; showQuestion(); } }

function submitAnswer(){
  const q = questions[currentIndex];
  let aText="";
  if(q.type==="essay"){ aText = document.getElementById("answerInput").value.trim(); if(!aText){ alert("Tulis jawaban dulu"); return; } }
  else if(q.type==="choice"){ aText = document.getElementById("choiceInput").value; }

  const badges = ["üéâ Mantap!","üåü Ide keren!","üî• Luar biasa!","ü´∂ Terima kasih sudah berbagi!","üí° Inspiratif!","üôå Hebat!"];
  const badge = badges[Math.floor(Math.random()*badges.length)];
  answers.unshift({question:q.q, answer:aText, nickname, badge, time:new Date().toLocaleString()});
  document.getElementById("answerInput").value="";
  document.getElementById("thanks").textContent = badge;
  confetti({particleCount:80, spread:70, origin:{y:0.6}});
}
function startRecording(){ if(!recognition){ alert("Browser tidak mendukung fitur rekaman suara."); return; } recognition.start(); }
function stopRecording(){ if(recognition){ recognition.stop(); } }
</script>
</body>
</html>
